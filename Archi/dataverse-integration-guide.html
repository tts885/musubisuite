<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dataverseçµ±åˆã‚¬ã‚¤ãƒ‰ - Power Apps Code Apps</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
        }
        .section {
            background: white;
            padding: 30px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .section h2 {
            color: #667eea;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-top: 0;
        }
        .section h3 {
            color: #764ba2;
            margin-top: 25px;
        }
        .code-block {
            background: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .code-block .keyword { color: #c678dd; }
        .code-block .string { color: #98c379; }
        .code-block .function { color: #61afef; }
        .code-block .comment { color: #5c6370; font-style: italic; }
        .code-block .variable { color: #e06c75; }
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .warning-box {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .success-box {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .step-list {
            counter-reset: step-counter;
            list-style: none;
            padding-left: 0;
        }
        .step-list li {
            counter-increment: step-counter;
            margin-bottom: 20px;
            padding-left: 60px;
            position: relative;
        }
        .step-list li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background: #667eea;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }
        .architecture-diagram {
            background: #f9f9f9;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        .flow-item {
            display: inline-block;
            background: white;
            border: 2px solid #764ba2;
            border-radius: 8px;
            padding: 15px 25px;
            margin: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .arrow {
            display: inline-block;
            color: #667eea;
            font-size: 2em;
            margin: 0 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        table th {
            background: #667eea;
            color: white;
            padding: 12px;
            text-align: left;
        }
        table td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }
        table tr:hover {
            background: #f5f5f5;
        }
        .tag {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            margin: 2px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“š Dataverseçµ±åˆã‚¬ã‚¤ãƒ‰</h1>
        <p>Power Apps Code Appsç’°å¢ƒã§ã®Dataverseæ¥ç¶šãƒ»ãƒ‡ãƒ¼ã‚¿æ“ä½œã®å®Œå…¨ã‚¬ã‚¤ãƒ‰</p>
        <p style="font-size: 0.9em;">ä½œæˆæ—¥: 2025å¹´11æœˆ18æ—¥ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.0</p>
    </div>

    <!-- ç›®æ¬¡ -->
    <div class="section">
        <h2>ğŸ“‘ ç›®æ¬¡</h2>
        <ul>
            <li><a href="#overview">1. æ¦‚è¦ã¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</a></li>
            <li><a href="#setup">2. ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</a></li>
            <li><a href="#connection">3. Dataverseæ¥ç¶šæ–¹æ³•</a></li>
            <li><a href="#crud">4. ãƒ‡ãƒ¼ã‚¿æ“ä½œ (CRUD)</a></li>
            <li><a href="#advanced">5. é«˜åº¦ãªæ“ä½œ</a></li>
            <li><a href="#troubleshooting">6. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</a></li>
            <li><a href="#best-practices">7. ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</a></li>
        </ul>
    </div>

    <!-- 1. æ¦‚è¦ã¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ -->
    <div class="section" id="overview">
        <h2>1. æ¦‚è¦ã¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</h2>
        
        <h3>1.1 ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</h3>
        <div class="architecture-diagram">
            <div class="flow-item">React Frontend<br/>(TypeScript)</div>
            <span class="arrow">â†’</span>
            <div class="flow-item">Power Apps SDK<br/>(@microsoft/power-apps)</div>
            <span class="arrow">â†’</span>
            <div class="flow-item">Dataverse<br/>(Cloud)</div>
        </div>

        <div class="info-box">
            <strong>ğŸ’¡ é‡è¦ãªç‰¹å¾´:</strong>
            <ul>
                <li>ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ä¸è¦ - React ã‹ã‚‰ç›´æ¥ Dataverse ã«æ¥ç¶š</li>
                <li>PAC CLI ã«ã‚ˆã‚‹è‡ªå‹•ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ</li>
                <li>TypeScript å‹å®‰å…¨æ€§ã®å®Œå…¨ã‚µãƒãƒ¼ãƒˆ</li>
                <li>Power Apps ç’°å¢ƒã§ã®å®Ÿè¡ŒãŒå¿…é ˆ</li>
            </ul>
        </div>

        <h3>1.2 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯</h3>
        <table>
            <tr>
                <th>ãƒ¬ã‚¤ãƒ¤ãƒ¼</th>
                <th>æŠ€è¡“</th>
                <th>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</th>
                <th>å½¹å‰²</th>
            </tr>
            <tr>
                <td>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰</td>
                <td>React</td>
                <td>19.1.1</td>
                <td>UI ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</td>
            </tr>
            <tr>
                <td>ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«</td>
                <td>Vite</td>
                <td>7.1.7</td>
                <td>é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ãƒ»ãƒ“ãƒ«ãƒ‰</td>
            </tr>
            <tr>
                <td>SDK</td>
                <td>@microsoft/power-apps</td>
                <td>0.3.21</td>
                <td>Dataverse æ¥ç¶š</td>
            </tr>
            <tr>
                <td>CLI</td>
                <td>PAC CLI</td>
                <td>1.50+</td>
                <td>ã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤</td>
            </tr>
            <tr>
                <td>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</td>
                <td>Dataverse</td>
                <td>Cloud</td>
                <td>ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</td>
            </tr>
        </table>

        <h3>1.3 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ </h3>
<div class="code-block">musubisuite/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ <span class="variable">services</span>/
â”‚   â”‚   â”œâ”€â”€ <span class="function">dataverseService.ts</span>       <span class="comment">// æ¥ç¶šç®¡ç†ã‚µãƒ¼ãƒ“ã‚¹</span>
â”‚   â”‚   â”œâ”€â”€ <span class="function">testMdiProjectList.ts</span>     <span class="comment">// ãƒ†ã‚¹ãƒˆãƒ»CRUDæ“ä½œ</span>
â”‚   â”‚   â””â”€â”€ <span class="function">tableCreationService.ts</span>   <span class="comment">// ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã‚¬ã‚¤ãƒ‰</span>
â”‚   â”œâ”€â”€ <span class="variable">generated</span>/                      <span class="comment">// PAC CLI è‡ªå‹•ç”Ÿæˆ</span>
â”‚   â”‚   â”œâ”€â”€ <span class="variable">services</span>/
â”‚   â”‚   â”‚   â””â”€â”€ <span class="function">Mdi_project_listsService.ts</span>
â”‚   â”‚   â””â”€â”€ <span class="variable">models</span>/
â”‚   â”‚       â””â”€â”€ <span class="function">Mdi_project_listsModel.ts</span>
â”‚   â””â”€â”€ <span class="variable">pages</span>/
â”‚       â””â”€â”€ <span class="function">dataverse-settings.tsx</span>     <span class="comment">// ç®¡ç†UI</span>
â””â”€â”€ <span class="function">power.config.json</span>                  <span class="comment">// Power Apps è¨­å®š</span>
</div>
    </div>

    <!-- 2. ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— -->
    <div class="section" id="setup">
        <h2>2. ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</h2>

        <h3>2.1 å‰ææ¡ä»¶</h3>
        <ul>
            <li>âœ… Power Platform ç’°å¢ƒ (é–‹ç™ºç’°å¢ƒ)</li>
            <li>âœ… Dataverse ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ‰åŠ¹åŒ–</li>
            <li>âœ… Dataverse ã¸ã®èª­ã¿å–ã‚Šãƒ»æ›¸ãè¾¼ã¿æ¨©é™</li>
            <li>âœ… PAC CLI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</li>
            <li>âœ… Node.js 18+ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</li>
        </ul>

        <h3>2.2 PAC CLI ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</h3>
        <ol class="step-list">
            <li>
                <strong>PAC CLI èªè¨¼</strong>
                <div class="code-block"><span class="comment"># ãƒ‡ãƒã‚¤ã‚¹ã‚³ãƒ¼ãƒ‰èªè¨¼ã§ãƒ­ã‚°ã‚¤ãƒ³</span>
pac auth create --deviceCode</div>
            </li>
            <li>
                <strong>ç’°å¢ƒã®é¸æŠ</strong>
                <div class="code-block"><span class="comment"># åˆ©ç”¨å¯èƒ½ãªç’°å¢ƒã‚’è¡¨ç¤º</span>
pac env list

<span class="comment"># ç’°å¢ƒã‚’é¸æŠ</span>
pac org select --environment <span class="string">"ç’°å¢ƒID ã¾ãŸã¯ ç’°å¢ƒå"</span></div>
            </li>
            <li>
                <strong>æ¥ç¶šç¢ºèª</strong>
                <div class="code-block"><span class="comment"># ç¾åœ¨ã®æ¥ç¶šçŠ¶æ…‹ã‚’ç¢ºèª</span>
pac org who</div>
            </li>
        </ol>

        <h3>2.3 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</h3>
<div class="code-block"><span class="comment"># ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</span>
<span class="keyword">npm</span> install

<span class="comment"># Power Apps SDK ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª</span>
<span class="keyword">npm</span> list @microsoft/power-apps

<span class="comment"># ã‚¢ãƒ—ãƒªã®èµ·å‹• (Power Apps ç’°å¢ƒã§å®Ÿè¡Œ)</span>
<span class="keyword">pac</span> code run
</div>

        <div class="warning-box">
            <strong>âš ï¸ é‡è¦:</strong> Power Apps SDK ã‚’ä½¿ç”¨ã—ãŸã‚¢ãƒ—ãƒªã¯ <code>pac code run</code> ã§èµ·å‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚é€šå¸¸ã® <code>npm run dev</code> ã§ã¯ Dataverse æ¥ç¶šãŒã§ãã¾ã›ã‚“ã€‚
        </div>
    </div>

    <!-- 3. Dataverseæ¥ç¶šæ–¹æ³• -->
    <div class="section" id="connection">
        <h2>3. Dataverse æ¥ç¶šæ–¹æ³•</h2>

        <h3>3.1 ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ã—ã¦è¿½åŠ </h3>
        <ol class="step-list">
            <li>
                <strong>PAC CLI ã§ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’è¿½åŠ </strong>
                <div class="code-block"><span class="comment"># æ—¢å­˜ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ã—ã¦è¿½åŠ </span>
pac code add-data-source <span class="keyword">-a</span> dataverse <span class="keyword">-t</span> <span class="string">mdi_project_list</span>

<span class="comment"># å®Ÿè¡Œçµæœ:</span>
<span class="comment"># âœ… src/generated/services/Mdi_project_listsService.ts</span>
<span class="comment"># âœ… src/generated/models/Mdi_project_listsModel.ts</span></div>
                <div class="info-box">
                    ã“ã®ã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚Šã€TypeScript ã®å‹å®šç¾©ã¨ CRUD ãƒ¡ã‚½ãƒƒãƒ‰ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚
                </div>
            </li>
            <li>
                <strong>è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«</strong>
                <ul>
                    <li><code>Service.ts</code> - CRUD æ“ä½œãƒ¡ã‚½ãƒƒãƒ‰ (create, read, update, delete)</li>
                    <li><code>Model.ts</code> - TypeScript å‹å®šç¾©ã€åˆ—æŒ™å‹</li>
                </ul>
            </li>
        </ol>

        <h3>3.2 Power Apps ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å–å¾—</h3>
<div class="code-block"><span class="keyword">import</span> { <span class="function">getContext</span> } <span class="keyword">from</span> <span class="string">'@microsoft/power-apps/app'</span>;

<span class="comment">/**
 * Power Apps ç’°å¢ƒæƒ…å ±ã‚’å–å¾—
 */</span>
<span class="keyword">export async function</span> <span class="function">getPowerAppsContext</span>() {
  <span class="keyword">try</span> {
    <span class="keyword">const</span> <span class="variable">context</span> = <span class="function">getContext</span>();
    <span class="keyword">return</span> {
      <span class="variable">success</span>: <span class="keyword">true</span>,
      <span class="variable">context</span>,
      <span class="variable">environmentId</span>: <span class="variable">context</span>?.<span class="variable">environment</span>?.<span class="variable">id</span>,
      <span class="variable">environmentUrl</span>: <span class="variable">context</span>?.<span class="variable">environment</span>?.<span class="variable">url</span>,
      <span class="variable">organizationName</span>: <span class="variable">context</span>?.<span class="variable">organization</span>?.<span class="variable">friendlyName</span>,
    };
  } <span class="keyword">catch</span> (<span class="variable">error</span>) {
    <span class="keyword">return</span> { <span class="variable">success</span>: <span class="keyword">false</span>, <span class="variable">error</span> };
  }
}
</div>

        <h3>3.3 æ¥ç¶šãƒ†ã‚¹ãƒˆ</h3>
<div class="code-block"><span class="keyword">import</span> { <span class="function">testDataverseConnection</span> } <span class="keyword">from</span> <span class="string">'@/services/dataverseService'</span>;

<span class="comment">// æ¥ç¶šã‚’ãƒ†ã‚¹ãƒˆ</span>
<span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="function">testDataverseConnection</span>({
  <span class="variable">environmentUrl</span>: <span class="string">'https://org288e66ae.crm.dynamics.com/'</span>,
  <span class="variable">displayName</span>: <span class="string">'é–‹ç™ºç’°å¢ƒ'</span>
});

<span class="keyword">if</span> (<span class="variable">result</span>.<span class="variable">success</span>) {
  <span class="function">console.log</span>(<span class="string">'âœ… æ¥ç¶šæˆåŠŸ'</span>, <span class="variable">result</span>.<span class="variable">details</span>);
} <span class="keyword">else</span> {
  <span class="function">console.error</span>(<span class="string">'âŒ æ¥ç¶šå¤±æ•—'</span>, <span class="variable">result</span>.<span class="variable">message</span>);
}
</div>
    </div>

    <!-- 4. ãƒ‡ãƒ¼ã‚¿æ“ä½œ (CRUD) -->
    <div class="section" id="crud">
        <h2>4. ãƒ‡ãƒ¼ã‚¿æ“ä½œ (CRUD)</h2>

        <h3>4.1 ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ä½œæˆ (Create)</h3>
<div class="code-block"><span class="keyword">import</span> { <span class="variable">Mdi_project_listsService</span> } <span class="keyword">from</span> <span class="string">'@/generated/services/Mdi_project_listsService'</span>;
<span class="keyword">import</span> <span class="keyword">type</span> { <span class="variable">Mdi_project_lists</span> } <span class="keyword">from</span> <span class="string">'@/generated/models/Mdi_project_listsModel'</span>;

<span class="comment">/**
 * æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ
 */</span>
<span class="keyword">async function</span> <span class="function">createProject</span>() {
  <span class="keyword">const</span> <span class="variable">newProject</span>: <span class="keyword">Partial</span>&lt;<span class="variable">Mdi_project_lists</span>&gt; = {
    <span class="variable">mdi_name</span>: <span class="string">'æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ'</span>,
    <span class="variable">mdi_id</span>: <span class="string">'PRJ001'</span>,           <span class="comment">// æœ€å¤§10æ–‡å­—</span>
    <span class="variable">mdi_project_description</span>: <span class="string">'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èª¬æ˜'</span>,
    <span class="variable">mdi_wbscode</span>: <span class="string">'WBS-001'</span>,
    <span class="variable">mdi_workload_mm</span>: <span class="string">'24'</span>,
  };

  <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">create</span>(<span class="variable">newProject</span> <span class="keyword">as</span> <span class="variable">Mdi_project_lists</span>);
  
  <span class="keyword">if</span> (<span class="variable">result</span>.<span class="variable">data</span>) {
    <span class="function">console.log</span>(<span class="string">'âœ… ä½œæˆæˆåŠŸ:'</span>, <span class="variable">result</span>.<span class="variable">data</span>.<span class="variable">mdi_project_listid</span>);
    <span class="keyword">return</span> <span class="variable">result</span>.<span class="variable">data</span>;
  }
}
</div>

        <div class="warning-box">
            <strong>âš ï¸ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰é•·åˆ¶é™ã«æ³¨æ„:</strong>
            <ul>
                <li><code>mdi_id</code>: æœ€å¤§10æ–‡å­—</li>
                <li>é•·ã™ãã‚‹å€¤ã‚’è¨­å®šã™ã‚‹ã¨ <code>StringLengthTooLong</code> ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ</li>
                <li>Dataverse ãŒè‡ªå‹•è¨­å®šã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ (<code>ownerid</code>, <code>createdby</code> ãªã©) ã¯é€ä¿¡ä¸è¦</li>
            </ul>
        </div>

        <h3>4.2 ãƒ¬ã‚³ãƒ¼ãƒ‰ã®èª­ã¿å–ã‚Š (Read)</h3>

        <h4>4.2.1 å…¨ãƒ¬ã‚³ãƒ¼ãƒ‰å–å¾—</h4>
<div class="code-block"><span class="comment">/**
 * å…¨ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
 */</span>
<span class="keyword">async function</span> <span class="function">getAllProjects</span>() {
  <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">getAll</span>({
    <span class="comment">// å–å¾—ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒ‡å®š (ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š)</span>
    <span class="variable">select</span>: [
      <span class="string">'mdi_project_listid'</span>,
      <span class="string">'mdi_name'</span>,
      <span class="string">'mdi_id'</span>,
      <span class="string">'createdon'</span>,
      <span class="string">'statecode'</span>
    ],
    <span class="comment">// æœ€å¤§å–å¾—ä»¶æ•°</span>
    <span class="variable">top</span>: <span class="keyword">100</span>,
    <span class="comment">// ã‚½ãƒ¼ãƒˆé †</span>
    <span class="variable">orderBy</span>: [<span class="string">'createdon desc'</span>]
  });

  <span class="keyword">return</span> <span class="variable">result</span>.<span class="variable">data</span> || [];
}
</div>

        <h4>4.2.2 å˜ä¸€ãƒ¬ã‚³ãƒ¼ãƒ‰å–å¾—</h4>
<div class="code-block"><span class="comment">/**
 * IDã§ç‰¹å®šã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
 */</span>
<span class="keyword">async function</span> <span class="function">getProjectById</span>(<span class="variable">projectId</span>: <span class="keyword">string</span>) {
  <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">get</span>(<span class="variable">projectId</span>);
  <span class="keyword">return</span> <span class="variable">result</span>.<span class="variable">data</span>;
}
</div>

        <h3>4.3 ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æ›´æ–° (Update)</h3>
<div class="code-block"><span class="comment">/**
 * æ—¢å­˜ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°
 */</span>
<span class="keyword">async function</span> <span class="function">updateProject</span>(<span class="variable">projectId</span>: <span class="keyword">string</span>) {
  <span class="keyword">const</span> <span class="variable">updates</span>: <span class="keyword">Partial</span>&lt;<span class="variable">Mdi_project_lists</span>&gt; = {
    <span class="variable">mdi_project_listid</span>: <span class="variable">projectId</span>,
    <span class="variable">mdi_name</span>: <span class="string">'æ›´æ–°å¾Œã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå'</span>,
    <span class="variable">mdi_workload_mm</span>: <span class="string">'36'</span>,
  };

  <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">update</span>(<span class="variable">updates</span> <span class="keyword">as</span> <span class="variable">Mdi_project_lists</span>);
  
  <span class="keyword">if</span> (<span class="variable">result</span>.<span class="variable">data</span>) {
    <span class="function">console.log</span>(<span class="string">'âœ… æ›´æ–°æˆåŠŸ'</span>);
    <span class="keyword">return</span> <span class="variable">result</span>.<span class="variable">data</span>;
  }
}
</div>

        <h3>4.4 ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å‰Šé™¤ (Delete)</h3>
<div class="code-block"><span class="comment">/**
 * ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤
 */</span>
<span class="keyword">async function</span> <span class="function">deleteProject</span>(<span class="variable">projectId</span>: <span class="keyword">string</span>) {
  <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">delete</span>(<span class="variable">projectId</span>);
  
  <span class="keyword">if</span> (<span class="variable">result</span>.<span class="variable">success</span>) {
    <span class="function">console.log</span>(<span class="string">'âœ… å‰Šé™¤æˆåŠŸ'</span>);
  }
}
</div>

        <h3>4.5 å®Ÿè£…ä¾‹: å®Œå…¨ãªCRUDæ“ä½œ</h3>
<div class="code-block"><span class="keyword">import</span> { <span class="variable">Mdi_project_listsService</span> } <span class="keyword">from</span> <span class="string">'@/generated/services/Mdi_project_listsService'</span>;

<span class="keyword">export class</span> <span class="function">ProjectManager</span> {
  <span class="comment">// ä½œæˆ</span>
  <span class="keyword">static async</span> <span class="function">create</span>(<span class="variable">data</span>: <span class="keyword">Partial</span>&lt;<span class="variable">Mdi_project_lists</span>&gt;) {
    <span class="keyword">try</span> {
      <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">create</span>(<span class="variable">data</span> <span class="keyword">as</span> <span class="variable">Mdi_project_lists</span>);
      <span class="keyword">return</span> { <span class="variable">success</span>: <span class="keyword">true</span>, <span class="variable">data</span>: <span class="variable">result</span>.<span class="variable">data</span> };
    } <span class="keyword">catch</span> (<span class="variable">error</span>) {
      <span class="keyword">return</span> { <span class="variable">success</span>: <span class="keyword">false</span>, <span class="variable">error</span> };
    }
  }

  <span class="comment">// èª­ã¿å–ã‚Š</span>
  <span class="keyword">static async</span> <span class="function">getAll</span>() {
    <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">getAll</span>({ <span class="variable">top</span>: <span class="keyword">100</span> });
    <span class="keyword">return</span> <span class="variable">result</span>.<span class="variable">data</span> || [];
  }

  <span class="comment">// æ›´æ–°</span>
  <span class="keyword">static async</span> <span class="function">update</span>(<span class="variable">id</span>: <span class="keyword">string</span>, <span class="variable">data</span>: <span class="keyword">Partial</span>&lt;<span class="variable">Mdi_project_lists</span>&gt;) {
    <span class="keyword">try</span> {
      <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">update</span>({
        <span class="variable">mdi_project_listid</span>: <span class="variable">id</span>,
        ...<span class="variable">data</span>
      } <span class="keyword">as</span> <span class="variable">Mdi_project_lists</span>);
      <span class="keyword">return</span> { <span class="variable">success</span>: <span class="keyword">true</span>, <span class="variable">data</span>: <span class="variable">result</span>.<span class="variable">data</span> };
    } <span class="keyword">catch</span> (<span class="variable">error</span>) {
      <span class="keyword">return</span> { <span class="variable">success</span>: <span class="keyword">false</span>, <span class="variable">error</span> };
    }
  }

  <span class="comment">// å‰Šé™¤</span>
  <span class="keyword">static async</span> <span class="function">delete</span>(<span class="variable">id</span>: <span class="keyword">string</span>) {
    <span class="keyword">try</span> {
      <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">delete</span>(<span class="variable">id</span>);
      <span class="keyword">return</span> { <span class="variable">success</span>: <span class="keyword">true</span> };
    } <span class="keyword">catch</span> (<span class="variable">error</span>) {
      <span class="keyword">return</span> { <span class="variable">success</span>: <span class="keyword">false</span>, <span class="variable">error</span> };
    }
  }
}
</div>
    </div>

    <!-- 5. é«˜åº¦ãªæ“ä½œ -->
    <div class="section" id="advanced">
        <h2>5. é«˜åº¦ãªæ“ä½œ</h2>

        <h3>5.1 ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°</h3>
<div class="code-block"><span class="comment">// ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã¿å–å¾—</span>
<span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">getAll</span>({
  <span class="variable">filter</span>: <span class="string">'statecode eq 0'</span>,  <span class="comment">// Active ã®ã¿</span>
  <span class="variable">select</span>: [<span class="string">'mdi_name'</span>, <span class="string">'mdi_id'</span>],
  <span class="variable">orderBy</span>: [<span class="string">'createdon desc'</span>]
});

<span class="comment">// è¤‡æ•°æ¡ä»¶ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°</span>
<span class="keyword">const</span> <span class="variable">filteredResult</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">getAll</span>({
  <span class="variable">filter</span>: <span class="string">'statecode eq 0 and mdi_workload_mm gt 12'</span>,
  <span class="variable">top</span>: <span class="keyword">50</span>
});
</div>

        <h3>5.2 ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³</h3>
<div class="code-block"><span class="comment">/**
 * ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ä»˜ããƒ‡ãƒ¼ã‚¿å–å¾—
 */</span>
<span class="keyword">async function</span> <span class="function">getPaginatedProjects</span>(<span class="variable">page</span>: <span class="keyword">number</span>, <span class="variable">pageSize</span>: <span class="keyword">number</span>) {
  <span class="keyword">const</span> <span class="variable">skip</span> = (<span class="variable">page</span> - <span class="keyword">1</span>) * <span class="variable">pageSize</span>;
  
  <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">getAll</span>({
    <span class="variable">top</span>: <span class="variable">pageSize</span>,
    <span class="variable">skip</span>: <span class="variable">skip</span>,
    <span class="variable">orderBy</span>: [<span class="string">'createdon desc'</span>]
  });

  <span class="keyword">return</span> {
    <span class="variable">data</span>: <span class="variable">result</span>.<span class="variable">data</span> || [],
    <span class="variable">page</span>,
    <span class="variable">pageSize</span>,
    <span class="variable">hasMore</span>: <span class="variable">result</span>.<span class="variable">data</span>?.<span class="variable">length</span> === <span class="variable">pageSize</span>
  };
}

<span class="comment">// ä½¿ç”¨ä¾‹</span>
<span class="keyword">const</span> <span class="variable">page1</span> = <span class="keyword">await</span> <span class="function">getPaginatedProjects</span>(<span class="keyword">1</span>, <span class="keyword">20</span>);
<span class="keyword">const</span> <span class="variable">page2</span> = <span class="keyword">await</span> <span class="function">getPaginatedProjects</span>(<span class="keyword">2</span>, <span class="keyword">20</span>);
</div>

        <h3>5.3 ãƒãƒƒãƒæ“ä½œ</h3>
<div class="code-block"><span class="comment">/**
 * è¤‡æ•°ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä¸€æ‹¬ä½œæˆ
 */</span>
<span class="keyword">async function</span> <span class="function">batchCreateProjects</span>(<span class="variable">projects</span>: <span class="keyword">Partial</span>&lt;<span class="variable">Mdi_project_lists</span>&gt;[]) {
  <span class="keyword">const</span> <span class="variable">results</span> = [];
  
  <span class="keyword">for</span> (<span class="keyword">const</span> <span class="variable">project</span> <span class="keyword">of</span> <span class="variable">projects</span>) {
    <span class="keyword">try</span> {
      <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">create</span>(<span class="variable">project</span> <span class="keyword">as</span> <span class="variable">Mdi_project_lists</span>);
      <span class="variable">results</span>.<span class="function">push</span>({ <span class="variable">success</span>: <span class="keyword">true</span>, <span class="variable">data</span>: <span class="variable">result</span>.<span class="variable">data</span> });
    } <span class="keyword">catch</span> (<span class="variable">error</span>) {
      <span class="variable">results</span>.<span class="function">push</span>({ <span class="variable">success</span>: <span class="keyword">false</span>, <span class="variable">error</span> });
    }
  }
  
  <span class="keyword">return</span> <span class="variable">results</span>;
}
</div>

        <h3>5.4 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</h3>
<div class="code-block"><span class="comment">/**
 * åŒ…æ‹¬çš„ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
 */</span>
<span class="keyword">async function</span> <span class="function">safeCreateProject</span>(<span class="variable">data</span>: <span class="keyword">Partial</span>&lt;<span class="variable">Mdi_project_lists</span>&gt;) {
  <span class="keyword">try</span> {
    <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">create</span>(<span class="variable">data</span> <span class="keyword">as</span> <span class="variable">Mdi_project_lists</span>);
    <span class="keyword">return</span> { <span class="variable">success</span>: <span class="keyword">true</span>, <span class="variable">data</span>: <span class="variable">result</span>.<span class="variable">data</span> };
    
  } <span class="keyword">catch</span> (<span class="variable">error</span>: <span class="keyword">any</span>) {
    <span class="comment">// ã‚¨ãƒ©ãƒ¼ç¨®é¡ã®åˆ¤å®š</span>
    <span class="keyword">if</span> (<span class="variable">error</span>.<span class="variable">response</span>?.<span class="variable">status</span> === <span class="keyword">400</span>) {
      <span class="keyword">const</span> <span class="variable">errorData</span> = <span class="variable">JSON</span>.<span class="function">parse</span>(<span class="variable">error</span>.<span class="variable">response</span>.<span class="variable">data</span>.<span class="variable">error</span>.<span class="variable">message</span>);
      
      <span class="keyword">if</span> (<span class="variable">errorData</span>.<span class="variable">error</span>.<span class="variable">code</span> === <span class="string">'0x80044331'</span>) {
        <span class="keyword">return</span> {
          <span class="variable">success</span>: <span class="keyword">false</span>,
          <span class="variable">error</span>: <span class="string">'StringLengthTooLong'</span>,
          <span class="variable">message</span>: <span class="string">'ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰é•·ãŒåˆ¶é™ã‚’è¶…ãˆã¦ã„ã¾ã™'</span>
        };
      }
    }
    
    <span class="keyword">return</span> {
      <span class="variable">success</span>: <span class="keyword">false</span>,
      <span class="variable">error</span>: <span class="string">'Unknown'</span>,
      <span class="variable">message</span>: <span class="variable">error</span>.<span class="variable">message</span> || <span class="string">'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'</span>
    };
  }
}
</div>
    </div>

    <!-- 6. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° -->
    <div class="section" id="troubleshooting">
        <h2>6. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2>

        <h3>6.1 ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾å‡¦æ³•</h3>
        
        <table>
            <tr>
                <th>ã‚¨ãƒ©ãƒ¼</th>
                <th>åŸå› </th>
                <th>å¯¾å‡¦æ³•</th>
            </tr>
            <tr>
                <td><code>Context is not available</code></td>
                <td>Power Appsç’°å¢ƒã§å®Ÿè¡Œã•ã‚Œã¦ã„ãªã„</td>
                <td><code>pac code run</code> ã§ã‚¢ãƒ—ãƒªã‚’èµ·å‹•</td>
            </tr>
            <tr>
                <td><code>StringLengthTooLong</code></td>
                <td>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰é•·åˆ¶é™è¶…é</td>
                <td>å…¥åŠ›å€¤ã‚’çŸ­ãã™ã‚‹ (ä¾‹: mdi_id ã¯10æ–‡å­—ã¾ã§)</td>
            </tr>
            <tr>
                <td><code>401 Unauthorized</code></td>
                <td>èªè¨¼ã‚¨ãƒ©ãƒ¼</td>
                <td><code>pac auth create</code> ã§å†èªè¨¼</td>
            </tr>
            <tr>
                <td><code>403 Forbidden</code></td>
                <td>æ¨©é™ä¸è¶³</td>
                <td>Dataverseãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®æ¨©é™ã‚’ç¢ºèª</td>
            </tr>
            <tr>
                <td><code>result.data is undefined</code></td>
                <td>ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ§‹é€ ã®å•é¡Œ</td>
                <td><code>result</code> è‡ªä½“ã‚’ãƒã‚§ãƒƒã‚¯</td>
            </tr>
        </table>

        <h3>6.2 ãƒ‡ãƒãƒƒã‚°æ–¹æ³•</h3>

        <h4>è©³ç´°ãƒ­ã‚°å‡ºåŠ›</h4>
<div class="code-block"><span class="comment">// ãƒ‡ãƒãƒƒã‚°ç”¨ã®è©³ç´°ãƒ­ã‚°</span>
<span class="keyword">async function</span> <span class="function">debugCreate</span>(<span class="variable">data</span>: <span class="keyword">any</span>) {
  <span class="function">console.log</span>(<span class="string">'ğŸ“¤ é€ä¿¡ãƒ‡ãƒ¼ã‚¿:'</span>, <span class="variable">JSON</span>.<span class="function">stringify</span>(<span class="variable">data</span>, <span class="keyword">null</span>, <span class="keyword">2</span>));
  
  <span class="keyword">try</span> {
    <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">create</span>(<span class="variable">data</span>);
    <span class="function">console.log</span>(<span class="string">'ğŸ“¥ ãƒ¬ã‚¹ãƒãƒ³ã‚¹:'</span>, <span class="variable">JSON</span>.<span class="function">stringify</span>(<span class="variable">result</span>, <span class="keyword">null</span>, <span class="keyword">2</span>));
    <span class="keyword">return</span> <span class="variable">result</span>;
  } <span class="keyword">catch</span> (<span class="variable">error</span>: <span class="keyword">any</span>) {
    <span class="function">console.error</span>(<span class="string">'âŒ ã‚¨ãƒ©ãƒ¼è©³ç´°:'</span>);
    <span class="function">console.error</span>(<span class="string">'  ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:'</span>, <span class="variable">error</span>.<span class="variable">response</span>?.<span class="variable">status</span>);
    <span class="function">console.error</span>(<span class="string">'  ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:'</span>, <span class="variable">error</span>.<span class="variable">message</span>);
    <span class="function">console.error</span>(<span class="string">'  ãƒ‡ãƒ¼ã‚¿:'</span>, <span class="variable">error</span>.<span class="variable">response</span>?.<span class="variable">data</span>);
    <span class="keyword">throw</span> <span class="variable">error</span>;
  }
}
</div>

        <h4>æ¥ç¶šãƒ†ã‚¹ãƒˆ</h4>
<div class="code-block"><span class="comment">// Power Apps æ¥ç¶šçŠ¶æ…‹ã®ç¢ºèª</span>
<span class="keyword">import</span> { <span class="function">getPowerAppsContext</span> } <span class="keyword">from</span> <span class="string">'@/services/dataverseService'</span>;

<span class="keyword">const</span> <span class="variable">context</span> = <span class="keyword">await</span> <span class="function">getPowerAppsContext</span>();
<span class="function">console.log</span>(<span class="string">'ğŸ”Œ æ¥ç¶šçŠ¶æ…‹:'</span>, <span class="variable">context</span>);
</div>

        <h3>6.3 ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</h3>
        <div class="info-box">
            <strong>âœ… ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</strong>
            <ol>
                <li>â–¡ <code>pac code run</code> ã§ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¦ã„ã‚‹ã‹?</li>
                <li>â–¡ PAC CLI ã§ç’°å¢ƒã«æ¥ç¶šæ¸ˆã¿ã‹? (<code>pac org who</code>)</li>
                <li>â–¡ ãƒ†ãƒ¼ãƒ–ãƒ«ãŒãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ã—ã¦è¿½åŠ æ¸ˆã¿ã‹?</li>
                <li>â–¡ å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã™ã¹ã¦è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹?</li>
                <li>â–¡ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰é•·åˆ¶é™ã‚’å®ˆã£ã¦ã„ã‚‹ã‹?</li>
                <li>â–¡ Dataverse ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®æ¨©é™ãŒã‚ã‚‹ã‹?</li>
                <li>â–¡ ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèªã—ãŸã‹?</li>
            </ol>
        </div>
    </div>

    <!-- 7. ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ -->
    <div class="section" id="best-practices">
        <h2>7. ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h2>

        <h3>7.1 ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„</h3>

        <div class="success-box">
            <strong>âœ… æ¨å¥¨äº‹é …</strong>
            <ul>
                <li>TypeScript ã®å‹å®šç¾©ã‚’æ´»ç”¨ (<code>Partial&lt;T&gt;</code>, <code>Required&lt;T&gt;</code>)</li>
                <li>ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯å¿…ãšå®Ÿè£…</li>
                <li><code>select</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿å–å¾—</li>
                <li>ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã§å¤§é‡ãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«å‡¦ç†</li>
                <li>ã‚µãƒ¼ãƒ“ã‚¹å±¤ã‚’åˆ†é›¢ã—ã¦ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ•´ç†</li>
            </ul>
        </div>

        <h3>7.2 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–</h3>

        <h4>å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿å–å¾—</h4>
<div class="code-block"><span class="comment">// âŒ Bad: ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å–å¾—</span>
<span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">getAll</span>();

<span class="comment">// âœ… Good: å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿æŒ‡å®š</span>
<span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">getAll</span>({
  <span class="variable">select</span>: [<span class="string">'mdi_project_listid'</span>, <span class="string">'mdi_name'</span>],
  <span class="variable">top</span>: <span class="keyword">50</span>
});
</div>

        <h4>ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥</h4>
<div class="code-block"><span class="comment">/**
 * React Query ã«ã‚ˆã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥
 */</span>
<span class="keyword">import</span> { <span class="function">useQuery</span> } <span class="keyword">from</span> <span class="string">'@tanstack/react-query'</span>;

<span class="keyword">export function</span> <span class="function">useProjects</span>() {
  <span class="keyword">return</span> <span class="function">useQuery</span>({
    <span class="variable">queryKey</span>: [<span class="string">'projects'</span>],
    <span class="variable">queryFn</span>: <span class="keyword">async</span> () => {
      <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">Mdi_project_listsService</span>.<span class="function">getAll</span>();
      <span class="keyword">return</span> <span class="variable">result</span>.<span class="variable">data</span> || [];
    },
    <span class="variable">staleTime</span>: <span class="keyword">5</span> * <span class="keyword">60</span> * <span class="keyword">1000</span>, <span class="comment">// 5åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥</span>
  });
}
</div>

        <h3>7.3 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</h3>

        <div class="warning-box">
            <strong>âš ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ³¨æ„äº‹é …</strong>
            <ul>
                <li>æ©Ÿå¯†æƒ…å ±ã‚’ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ä¿å­˜ã—ãªã„</li>
                <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›å€¤ã¯å¿…ãšãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³</li>
                <li>Dataverse ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ãƒ¼ãƒ«ã§æ¨©é™ã‚’é©åˆ‡ã«è¨­å®š</li>
                <li>SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­– (ãƒ•ã‚£ãƒ«ã‚¿æ–‡å­—åˆ—ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—)</li>
            </ul>
        </div>

        <h3>7.4 ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ä¾‹</h3>
<div class="code-block"><span class="comment">/**
 * Vitest ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆä¾‹
 */</span>
<span class="keyword">import</span> { <span class="function">describe</span>, <span class="function">it</span>, <span class="function">expect</span> } <span class="keyword">from</span> <span class="string">'vitest'</span>;
<span class="keyword">import</span> { <span class="variable">ProjectManager</span> } <span class="keyword">from</span> <span class="string">'./ProjectManager'</span>;

<span class="function">describe</span>(<span class="string">'ProjectManager'</span>, () => {
  <span class="function">it</span>(<span class="string">'should create project'</span>, <span class="keyword">async</span> () => {
    <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">ProjectManager</span>.<span class="function">create</span>({
      <span class="variable">mdi_name</span>: <span class="string">'Test Project'</span>,
      <span class="variable">mdi_id</span>: <span class="string">'TEST001'</span>
    });

    <span class="function">expect</span>(<span class="variable">result</span>.<span class="variable">success</span>).<span class="function">toBe</span>(<span class="keyword">true</span>);
    <span class="function">expect</span>(<span class="variable">result</span>.<span class="variable">data</span>?.<span class="variable">mdi_name</span>).<span class="function">toBe</span>(<span class="string">'Test Project'</span>);
  });

  <span class="function">it</span>(<span class="string">'should handle validation error'</span>, <span class="keyword">async</span> () => {
    <span class="keyword">const</span> <span class="variable">result</span> = <span class="keyword">await</span> <span class="variable">ProjectManager</span>.<span class="function">create</span>({
      <span class="variable">mdi_name</span>: <span class="string">'Test'</span>,
      <span class="variable">mdi_id</span>: <span class="string">'VERY-LONG-ID-THAT-EXCEEDS-LIMIT'</span>
    });

    <span class="function">expect</span>(<span class="variable">result</span>.<span class="variable">success</span>).<span class="function">toBe</span>(<span class="keyword">false</span>);
    <span class="function">expect</span>(<span class="variable">result</span>.<span class="variable">error</span>).<span class="function">toBe</span>(<span class="string">'StringLengthTooLong'</span>);
  });
});
</div>

        <h3>7.5 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h3>
<div class="code-block">src/
â”œâ”€â”€ <span class="variable">services</span>/
â”‚   â”œâ”€â”€ <span class="function">dataverse/</span>              <span class="comment">// Dataverse é–¢é€£ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã¾ã¨ã‚ã‚‹</span>
â”‚   â”‚   â”œâ”€â”€ <span class="function">connection.ts</span>       <span class="comment">// æ¥ç¶šç®¡ç†</span>
â”‚   â”‚   â”œâ”€â”€ <span class="function">projects.ts</span>         <span class="comment">// ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œ</span>
â”‚   â”‚   â””â”€â”€ <span class="function">common.ts</span>           <span class="comment">// å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£</span>
â”‚   â””â”€â”€ <span class="function">api/</span>
â”œâ”€â”€ <span class="variable">hooks</span>/
â”‚   â””â”€â”€ <span class="function">useDataverse.ts</span>       <span class="comment">// ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯</span>
â”œâ”€â”€ <span class="variable">types</span>/
â”‚   â””â”€â”€ <span class="function">dataverse.ts</span>          <span class="comment">// å‹å®šç¾©</span>
â””â”€â”€ <span class="variable">generated</span>/                  <span class="comment">// PAC CLI ç”Ÿæˆ (ç·¨é›†ä¸å¯)</span>
</div>
    </div>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <div class="section" style="text-align: center; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <h3 style="margin: 0;">ğŸ‰ Dataverseçµ±åˆã‚’æ´»ç”¨ã—ã¦ç´ æ™´ã‚‰ã—ã„ã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã—ã¾ã—ã‚‡ã†!</h3>
        <p style="margin: 10px 0 0 0; opacity: 0.9;">Power Apps Code Apps Ã— Dataverse</p>
        <p style="margin: 5px 0 0 0; font-size: 0.9em;">
            <span class="tag">React</span>
            <span class="tag">TypeScript</span>
            <span class="tag">Dataverse</span>
            <span class="tag">Power Platform</span>
        </p>
    </div>

    <script>
        // ã‚¹ãƒ ãƒ¼ã‚¹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½
        document.querySelectorAll('.code-block').forEach(block => {
            const button = document.createElement('button');
            button.textContent = 'ğŸ“‹ Copy';
            button.style.cssText = 'position: absolute; top: 10px; right: 10px; background: #667eea; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;';
            block.style.position = 'relative';
            block.appendChild(button);

            button.addEventListener('click', () => {
                const code = block.innerText.replace('ğŸ“‹ Copy', '').trim();
                navigator.clipboard.writeText(code).then(() => {
                    button.textContent = 'âœ… Copied!';
                    setTimeout(() => button.textContent = 'ğŸ“‹ Copy', 2000);
                });
            });
        });
    </script>
</body>
</html>
