# APIè¨­è¨ˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

## ğŸ“‹ ç›®æ¬¡
- [APIè¨­è¨ˆåŸå‰‡](#apiè¨­è¨ˆåŸå‰‡)
- [RESTful APIè¦ç´„](#restful-apiè¦ç´„)
- [ãƒªã‚¯ã‚¨ã‚¹ãƒˆè¨­è¨ˆ](#ãƒªã‚¯ã‚¨ã‚¹ãƒˆè¨­è¨ˆ)
- [ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¨­è¨ˆ](#ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¨­è¨ˆ)
- [ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°](#ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°)
- [ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³](#ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³)
- [ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»æ¤œç´¢](#ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¤œç´¢)
- [ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°](#ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°)

## APIè¨­è¨ˆåŸå‰‡

### 1. ä¸€è²«æ€§
- ã™ã¹ã¦ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§çµ±ä¸€ã•ã‚ŒãŸå‘½åè¦å‰‡
- çµ±ä¸€ã•ã‚ŒãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹æ§‹é€ 
- äºˆæ¸¬å¯èƒ½ãªã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹

### 2. RESTfulåŸå‰‡
- ãƒªã‚½ãƒ¼ã‚¹æŒ‡å‘ã®è¨­è¨ˆ
- é©åˆ‡ãªHTTPãƒ¡ã‚½ãƒƒãƒ‰ã®ä½¿ç”¨
- ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ãªé€šä¿¡

### 3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ
- èªè¨¼ãƒ»èªå¯ã®å¾¹åº•
- å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™

### 4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- åŠ¹ç‡çš„ãªã‚¯ã‚¨ãƒª
- é©åˆ‡ãªã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°
- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³

### 5. é–‹ç™ºè€…ä½“é¨“
- æ˜ç¢ºãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- ã‚ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- ä¸€è²«ã—ãŸãƒãƒ¼ãƒŸãƒ³ã‚°

## RESTful APIè¦ç´„

### HTTPãƒ¡ã‚½ãƒƒãƒ‰

| ãƒ¡ã‚½ãƒƒãƒ‰ | ç”¨é€” | å†ªç­‰æ€§ | å®‰å…¨æ€§ |
|---------|------|--------|--------|
| GET | ãƒªã‚½ãƒ¼ã‚¹å–å¾— | âœ… | âœ… |
| POST | ãƒªã‚½ãƒ¼ã‚¹ä½œæˆ | âŒ | âŒ |
| PUT | ãƒªã‚½ãƒ¼ã‚¹å…¨ä½“æ›´æ–° | âœ… | âŒ |
| PATCH | ãƒªã‚½ãƒ¼ã‚¹éƒ¨åˆ†æ›´æ–° | âŒ | âŒ |
| DELETE | ãƒªã‚½ãƒ¼ã‚¹å‰Šé™¤ | âœ… | âŒ |

### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¨­è¨ˆ

#### åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³
```
# ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆè¤‡æ•°å½¢ã‚’ä½¿ç”¨ï¼‰
GET    /api/projects/              # ä¸€è¦§å–å¾—
POST   /api/projects/              # æ–°è¦ä½œæˆ

# å˜ä¸€ãƒªã‚½ãƒ¼ã‚¹
GET    /api/projects/{id}/         # è©³ç´°å–å¾—
PUT    /api/projects/{id}/         # å…¨ä½“æ›´æ–°
PATCH  /api/projects/{id}/         # éƒ¨åˆ†æ›´æ–°
DELETE /api/projects/{id}/         # å‰Šé™¤
```

#### ãƒã‚¹ãƒˆã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹
```
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ç´ã¥ãã‚¿ã‚¹ã‚¯
GET    /api/projects/{id}/tasks/           # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¿ã‚¹ã‚¯ä¸€è¦§
POST   /api/projects/{id}/tasks/           # ã‚¿ã‚¹ã‚¯ä½œæˆ
GET    /api/projects/{id}/tasks/{task_id}/ # ã‚¿ã‚¹ã‚¯è©³ç´°

# ãƒã‚¹ãƒˆã¯2éšå±¤ã¾ã§æ¨å¥¨
# âŒ /api/projects/{id}/tasks/{task_id}/comments/{comment_id}/
# âœ… /api/comments/{comment_id}/
```

#### ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
```
# ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹ç‰¹æ®Šãªæ“ä½œ
POST   /api/projects/{id}/complete/    # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Œäº†
POST   /api/projects/{id}/archive/     # ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
POST   /api/tasks/{id}/assign/         # ã‚¿ã‚¹ã‚¯å‰²ã‚Šå½“ã¦

# ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ãƒ™ãƒ«ã®æ“ä½œ
GET    /api/projects/active/           # é€²è¡Œä¸­ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
GET    /api/projects/search/           # æ¤œç´¢
POST   /api/projects/bulk-create/      # ä¸€æ‹¬ä½œæˆ
```

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰

#### æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹

| ã‚³ãƒ¼ãƒ‰ | æ„å‘³ | ä½¿ç”¨ã‚±ãƒ¼ã‚¹ |
|-------|------|-----------|
| 200 OK | æˆåŠŸ | GET, PUT, PATCH, DELETEæˆåŠŸ |
| 201 Created | ä½œæˆæˆåŠŸ | POSTæˆåŠŸï¼ˆæ–°è¦ãƒªã‚½ãƒ¼ã‚¹ä½œæˆï¼‰ |
| 204 No Content | æˆåŠŸï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãªã—ï¼‰ | DELETEæˆåŠŸï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ãªã—ï¼‰ |

#### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¨ãƒ©ãƒ¼

| ã‚³ãƒ¼ãƒ‰ | æ„å‘³ | ä½¿ç”¨ã‚±ãƒ¼ã‚¹ |
|-------|------|-----------|
| 400 Bad Request | ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆ | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ |
| 401 Unauthorized | æœªèªè¨¼ | ãƒˆãƒ¼ã‚¯ãƒ³ãªã—ãƒ»ç„¡åŠ¹ |
| 403 Forbidden | æ¨©é™ãªã— | ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ä¸è¶³ |
| 404 Not Found | ãƒªã‚½ãƒ¼ã‚¹ãªã— | å­˜åœ¨ã—ãªã„ID |
| 409 Conflict | ç«¶åˆ | é‡è¤‡ãƒ‡ãƒ¼ã‚¿ä½œæˆ |
| 422 Unprocessable Entity | å‡¦ç†ä¸å¯ | ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼ |
| 429 Too Many Requests | ãƒªã‚¯ã‚¨ã‚¹ãƒˆéå¤š | ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¶…é |

#### ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼

| ã‚³ãƒ¼ãƒ‰ | æ„å‘³ | ä½¿ç”¨ã‚±ãƒ¼ã‚¹ |
|-------|------|-----------|
| 500 Internal Server Error | ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ | äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ |
| 502 Bad Gateway | ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚¨ãƒ©ãƒ¼ | ä¸Šæµã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ |
| 503 Service Unavailable | ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨ä¸å¯ | ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä¸­ |

## ãƒªã‚¯ã‚¨ã‚¹ãƒˆè¨­è¨ˆ

### ãƒ˜ãƒƒãƒ€ãƒ¼

#### å¿…é ˆãƒ˜ãƒƒãƒ€ãƒ¼
```http
Content-Type: application/json
Accept: application/json
Authorization: Bearer {access_token}
```

#### æ¨å¥¨ãƒ˜ãƒƒãƒ€ãƒ¼
```http
Accept-Language: ja
X-Request-ID: {uuid}  # ãƒªã‚¯ã‚¨ã‚¹ãƒˆè¿½è·¡ç”¨
User-Agent: /1.0.0
```

### ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£

#### JSONå½¢å¼ï¼ˆæ¨å¥¨ï¼‰
```json
{
  "name": "æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ",
  "description": "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èª¬æ˜",
  "start_date": "2025-01-01",
  "end_date": "2025-12-31",
  "status": "planning",
  "budget": 1000000
}
```

#### ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å‘½åè¦å‰‡
- **snake_case**: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API
- **camelCase**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆå¤‰æ›ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§å¯¾å¿œï¼‰

```typescript
// ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (camelCase)
const project = {
  startDate: "2025-01-01",
  endDate: "2025-12-31"
};

// APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå¤‰æ› (snake_case)
const apiData = {
  start_date: project.startDate,
  end_date: project.endDate
};
```

### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

#### å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
```json
{
  "name": "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå",  // å¿…é ˆ
  "start_date": "2025-01-01"  // å¿…é ˆ
}
```

#### ãƒ‡ãƒ¼ã‚¿å‹
```json
{
  "name": "string",
  "budget": "number (decimal)",
  "start_date": "string (ISO 8601)",
  "is_active": "boolean",
  "members": "array"
}
```

## ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¨­è¨ˆ

### æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹

#### å˜ä¸€ãƒªã‚½ãƒ¼ã‚¹
```json
{
  "id": "123e4567-e89b-12d3-a456-426614174000",
  "name": "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå",
  "description": "èª¬æ˜",
  "start_date": "2025-01-01",
  "end_date": "2025-12-31",
  "status": "active",
  "budget": 1000000.00,
  "member_count": 5,
  "task_count": 20,
  "is_overdue": false,
  "created_at": "2025-01-01T00:00:00Z",
  "updated_at": "2025-01-15T10:30:00Z"
}
```

#### ãƒªã‚½ãƒ¼ã‚¹ä¸€è¦§ï¼ˆãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ãªã—ï¼‰
```json
[
  {
    "id": "123e4567-e89b-12d3-a456-426614174000",
    "name": "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ1",
    "status": "active"
  },
  {
    "id": "223e4567-e89b-12d3-a456-426614174001",
    "name": "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ2",
    "status": "completed"
  }
]
```

#### ãƒªã‚½ãƒ¼ã‚¹ä¸€è¦§ï¼ˆãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚ã‚Šï¼‰
```json
{
  "count": 100,
  "next": "http://api.example.com/api/projects/?page=3",
  "previous": "http://api.example.com/api/projects/?page=1",
  "results": [
    {
      "id": "123e4567-e89b-12d3-a456-426614174000",
      "name": "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ1",
      "status": "active"
    }
  ]
}
```

#### ä½œæˆæˆåŠŸï¼ˆ201 Createdï¼‰
```json
// ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
POST /api/projects/
{
  "name": "æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ",
  "start_date": "2025-01-01"
}

// ãƒ¬ã‚¹ãƒãƒ³ã‚¹
Status: 201 Created
Location: /api/projects/123e4567-e89b-12d3-a456-426614174000/
{
  "id": "123e4567-e89b-12d3-a456-426614174000",
  "name": "æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ",
  "start_date": "2025-01-01",
  "status": "planning",
  "created_at": "2025-01-01T00:00:00Z"
}
```

### ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹

#### åŸºæœ¬æ§‹é€ 
```json
{
  "error": {
    "status_code": 400,
    "message": "ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼",
    "details": {
      "name": ["ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¯å¿…é ˆã§ã™"],
      "end_date": ["çµ‚äº†æ—¥ã¯é–‹å§‹æ—¥ä»¥é™ã®æ—¥ä»˜ã‚’æŒ‡å®šã—ã¦ãã ã•ã„"]
    },
    "timestamp": "2025-01-01T00:00:00Z",
    "path": "/api/projects/"
  }
}
```

#### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ï¼ˆ400ï¼‰
```json
{
  "error": {
    "status_code": 400,
    "message": "ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼",
    "details": {
      "name": [
        "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¯å¿…é ˆã§ã™",
        "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¯200æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„"
      ],
      "budget": [
        "äºˆç®—ã¯0ä»¥ä¸Šã§æŒ‡å®šã—ã¦ãã ã•ã„"
      ]
    }
  }
}
```

#### èªè¨¼ã‚¨ãƒ©ãƒ¼ï¼ˆ401ï¼‰
```json
{
  "error": {
    "status_code": 401,
    "message": "èªè¨¼ãŒå¿…è¦ã§ã™",
    "details": {
      "reason": "ãƒˆãƒ¼ã‚¯ãƒ³ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã›ã‚“"
    }
  }
}
```

#### èªå¯ã‚¨ãƒ©ãƒ¼ï¼ˆ403ï¼‰
```json
{
  "error": {
    "status_code": 403,
    "message": "ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“",
    "details": {
      "reason": "ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç·¨é›†ã™ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"
    }
  }
}
```

#### ãƒªã‚½ãƒ¼ã‚¹ãªã—ï¼ˆ404ï¼‰
```json
{
  "error": {
    "status_code": 404,
    "message": "ãƒªã‚½ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“",
    "details": {
      "resource": "Project",
      "id": "invalid-id"
    }
  }
}
```

#### ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ï¼ˆ500ï¼‰
```json
{
  "error": {
    "status_code": 500,
    "message": "ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ",
    "details": {
      "error_id": "err_123456",
      "message": "äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãã—ã¦ã‹ã‚‰å†åº¦ãŠè©¦ã—ãã ã•ã„"
    }
  }
}
```

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…

```typescript
// src/services/djangoAPI.ts
import axios, { AxiosError } from 'axios';
import { toast } from 'sonner';

interface APIError {
  error: {
    status_code: number;
    message: string;
    details: Record<string, string[]> | { reason?: string };
  };
}

export async function handleAPIError(error: unknown): Promise<never> {
  if (axios.isAxiosError(error)) {
    const axiosError = error as AxiosError<APIError>;
    const apiError = axiosError.response?.data?.error;
    
    if (apiError) {
      // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼
      if (apiError.status_code === 400 && typeof apiError.details === 'object') {
        const messages = Object.entries(apiError.details)
          .map(([field, errors]) => `${field}: ${errors.join(', ')}`)
          .join('\n');
        toast.error('å…¥åŠ›ã‚¨ãƒ©ãƒ¼', { description: messages });
      }
      // èªè¨¼ã‚¨ãƒ©ãƒ¼
      else if (apiError.status_code === 401) {
        toast.error('èªè¨¼ã‚¨ãƒ©ãƒ¼', { description: 'å†åº¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„' });
        // ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
        window.location.href = '/login';
      }
      // æ¨©é™ã‚¨ãƒ©ãƒ¼
      else if (apiError.status_code === 403) {
        toast.error('æ¨©é™ã‚¨ãƒ©ãƒ¼', { description: apiError.message });
      }
      // ãã®ä»–ã®ã‚¨ãƒ©ãƒ¼
      else {
        toast.error('ã‚¨ãƒ©ãƒ¼', { description: apiError.message });
      }
    } else {
      // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼
      toast.error('ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼', {
        description: 'ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã§ãã¾ã›ã‚“ã§ã—ãŸ',
      });
    }
  } else {
    toast.error('äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼', {
      description: 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    });
  }
  
  throw error;
}

// ä½¿ç”¨ä¾‹
try {
  const project = await projectService.create(data);
  return project;
} catch (error) {
  handleAPIError(error);
}
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…

```python
# config/exceptions.py
from rest_framework.views import exception_handler
from rest_framework.response import Response
from rest_framework import status
from django.utils import timezone
import logging

logger = logging.getLogger(__name__)

def custom_exception_handler(exc, context):
    """ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒ©ãƒ¼"""
    response = exception_handler(exc, context)
    
    if response is not None:
        # ãƒªã‚¯ã‚¨ã‚¹ãƒˆæƒ…å ±å–å¾—
        request = context.get('request')
        path = request.path if request else ''
        
        # ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹
        error_response = {
            'error': {
                'status_code': response.status_code,
                'message': get_error_message(exc, response.status_code),
                'details': response.data,
                'timestamp': timezone.now().isoformat(),
                'path': path,
            }
        }
        
        # ãƒ­ã‚°è¨˜éŒ²
        logger.error(f"API Error: {response.status_code} - {path}", extra={
            'exception': str(exc),
            'status_code': response.status_code,
        })
        
        return Response(error_response, status=response.status_code)
    
    # äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼
    logger.exception("Unhandled exception", exc_info=exc)
    return Response({
        'error': {
            'status_code': 500,
            'message': 'ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
            'details': {'message': str(exc)},
            'timestamp': timezone.now().isoformat(),
        }
    }, status=status.HTTP_500_INTERNAL_SERVER_ERROR)

def get_error_message(exc, status_code):
    """ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«å¿œã˜ãŸã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"""
    messages = {
        400: 'ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼',
        401: 'èªè¨¼ãŒå¿…è¦ã§ã™',
        403: 'ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“',
        404: 'ãƒªã‚½ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
        409: 'ãƒ‡ãƒ¼ã‚¿ã®ç«¶åˆãŒç™ºç”Ÿã—ã¾ã—ãŸ',
        422: 'å‡¦ç†ã§ããªã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã™',
        500: 'ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    }
    return messages.get(status_code, str(exc))
```

## ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³

### Django REST Frameworkå®Ÿè£…

```python
# config/settings.py
REST_FRAMEWORK = {
    'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
    'PAGE_SIZE': 20,
}

# ã‚«ã‚¹ã‚¿ãƒ ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
from rest_framework.pagination import PageNumberPagination

class StandardResultsSetPagination(PageNumberPagination):
    page_size = 20
    page_size_query_param = 'page_size'
    max_page_size = 100

# views.py
class ProjectViewSet(viewsets.ModelViewSet):
    pagination_class = StandardResultsSetPagination
```

### ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹

```
GET /api/projects/?page=2&page_size=10
```

### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹

```json
{
  "count": 45,
  "next": "http://api.example.com/api/projects/?page=3&page_size=10",
  "previous": "http://api.example.com/api/projects/?page=1&page_size=10",
  "results": [
    {
      "id": "123",
      "name": "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ1"
    }
  ]
}
```

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…

```typescript
// TanStack Queryã§ã®ç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
export function useInfiniteProjects() {
  return useInfiniteQuery({
    queryKey: ['projects', 'infinite'],
    queryFn: ({ pageParam = 1 }) => 
      projectService.getAll({ page: pageParam }),
    getNextPageParam: (lastPage) => {
      // nextãŒnullã®å ´åˆã¯æœ€å¾Œã®ãƒšãƒ¼ã‚¸
      return lastPage.next ? lastPage.page + 1 : undefined;
    },
  });
}

// ä½¿ç”¨ä¾‹
function ProjectsList() {
  const {
    data,
    fetchNextPage,
    hasNextPage,
    isFetchingNextPage,
  } = useInfiniteProjects();
  
  return (
    <div>
      {data?.pages.map((page) => (
        page.results.map(project => (
          <ProjectCard key={project.id} project={project} />
        ))
      ))}
      
      {hasNextPage && (
        <Button onClick={() => fetchNextPage()} disabled={isFetchingNextPage}>
          {isFetchingNextPage ? 'èª­ã¿è¾¼ã¿ä¸­...' : 'ã‚‚ã£ã¨è¦‹ã‚‹'}
        </Button>
      )}
    </div>
  );
}
```

## ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»æ¤œç´¢

### ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

```
# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
GET /api/projects/?status=active

# æ—¥ä»˜ç¯„å›²ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
GET /api/projects/?start_date_from=2025-01-01&start_date_to=2025-12-31

# æ¤œç´¢
GET /api/projects/?search=ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

# ã‚½ãƒ¼ãƒˆ
GET /api/projects/?ordering=-created_at

# è¤‡æ•°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
GET /api/projects/?status=active&search=é‡è¦&ordering=-start_date
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…

```python
# views.py
from django_filters import rest_framework as filters

class ProjectFilter(filters.FilterSet):
    """ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼"""
    
    start_date_from = filters.DateFilter(field_name='start_date', lookup_expr='gte')
    start_date_to = filters.DateFilter(field_name='start_date', lookup_expr='lte')
    
    class Meta:
        model = Project
        fields = {
            'status': ['exact', 'in'],
            'name': ['icontains'],
        }

class ProjectViewSet(viewsets.ModelViewSet):
    queryset = Project.objects.all()
    serializer_class = ProjectSerializer
    filterset_class = ProjectFilter
    search_fields = ['name', 'description']
    ordering_fields = ['created_at', 'start_date', 'status']
```

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…

```typescript
// ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç®¡ç†
interface ProjectFilters {
  status?: string;
  search?: string;
  start_date_from?: string;
  start_date_to?: string;
  ordering?: string;
}

export function useFilteredProjects(filters: ProjectFilters) {
  return useQuery({
    queryKey: ['projects', filters],
    queryFn: () => projectService.getAll(filters),
  });
}

// ä½¿ç”¨ä¾‹
function ProjectsList() {
  const [filters, setFilters] = useState<ProjectFilters>({
    status: 'active',
  });
  
  const { data: projects } = useFilteredProjects(filters);
  
  return (
    <div>
      <select
        value={filters.status}
        onChange={(e) => setFilters({ ...filters, status: e.target.value })}
      >
        <option value="">ã™ã¹ã¦</option>
        <option value="active">é€²è¡Œä¸­</option>
        <option value="completed">å®Œäº†</option>
      </select>
      
      {/* ... */}
    </div>
  );
}
```

## ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°

### URL ãƒ‘ã‚¹ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ï¼ˆæ¨å¥¨ï¼‰

```
GET /api/v1/projects/
GET /api/v2/projects/
```

```python
# config/urls.py
urlpatterns = [
    path('api/v1/', include('api.v1.urls')),
    path('api/v2/', include('api.v2.urls')),
]
```

### ãƒ˜ãƒƒãƒ€ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°

```http
GET /api/projects/
Accept: application/vnd..v1+json
```

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†æˆ¦ç•¥

1. **ä¸‹ä½äº’æ›æ€§ã®ç¶­æŒ**
   - æ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‰Šé™¤ç¦æ­¢
   - æ–°è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«

2. **ãƒãƒ¼ã‚¸ãƒ§ãƒ³å»ƒæ­¢ãƒ—ãƒ­ã‚»ã‚¹**
   - å»ƒæ­¢äºˆå®šã®é€šçŸ¥ï¼ˆ6ãƒ¶æœˆå‰ï¼‰
   - ç§»è¡Œã‚¬ã‚¤ãƒ‰ã®æä¾›
   - ã‚µãƒãƒ¼ãƒˆçµ‚äº†

3. **ãƒãƒ¼ã‚¸ãƒ§ãƒ³é¸æŠ**
   - v1: å®‰å®šç‰ˆ
   - v2: æ–°æ©Ÿèƒ½
   - beta: å®Ÿé¨“çš„æ©Ÿèƒ½

---

**Version**: 1.0.0  
**Last Updated**: 2025å¹´11æœˆ14æ—¥
